\Opensolutionfile{solution_file}[solutions/sols_010]
% в квадратных скобках фактическое имя файла

\chapter{Стационарные процессы}

Сюда относятся задачи на стационарность до явного упоминания ARMA/ARIMA :)

\begin{problem}
Запишите процесс $y_t = 4 + 0.4y_{t-1} + 0.3\e_{t-1} + \e_t$ с помощью оператора лага.
\begin{sol}
\[
(1 - 0.4L)y_t = 4 + (1 + 0.3L)\e_t
\]
\end{sol}
\end{problem}


\begin{problem}
Пусть $x_{t}$, $t=0,1,2, \ldots$ — случайный процесс и $y_{t}=(1+L)^{t}x_{t}$.
Выразите $x_{t}$ с помощью $y_{t}$ и оператора лага $L$.

\begin{sol}
$x_{t}=(1-L)^{t}y_{t}$
\end{sol}
\end{problem}

\begin{problem}
Пусть $ F_{n} $ — последовательность чисел Фибоначчи. Рассмотрим величину
\[
\frac{F_{101}+C^{1}_{5}F_{102}+C^{2}_{5}F_{103}+C^{3}_{5}F_{104}+C^{4}_{5}F_{105}+C^{5}_{5}F_{106}}
{F_{111}}
\]
\begin{enumerate}
\item Запишите величину с помощью оператора лага
\item Упростите величину
\end{enumerate}

\begin{sol}
$ F_{n}=L(1+L)F_{n} $, значит $ F_{n}=L^{k}(1+L)^{k}F_{n} $ или $ F_{n+k}=(1+L)^{k}F_{n} $

Ответ: $1$
\end{sol}
\end{problem}




\begin{problem}
Пусть $x_{t}$, $t=\ldots -2,-1,0,1,2,\ldots $ — случайный процесс. И $y_{t}=x_{-t}$. Какое рассуждение верно?

\begin{enumerate}
\item $Ly_{t}=Lx_{-t}=x_{-t-1}$;
\item $Ly_{t}=y_{t-1}=x_{-t+1}$;
\item $x_t L y_t = x_t y_{t-1}$;
\item $x_t L y_t = x_{t-1} y_t$;
\end{enumerate}
\begin{sol}
а — неверно, б — верно, в — верно, г — нет.
\end{sol}
\end{problem}

%%%%%%%%%%%%%%%%% стационарность

\begin{problem}
Пусть $y_{t}$ — стационарный процесс. Верно ли, что стационарны:
\begin{enumerate}
\item $z_{t}=2y_{t}$
\item $z_{t}=y_{t}+1$
\item $z_{t}=\Delta y_{t}$
\item $z_{t}=2y_{t}+3y_{t-1}$
\end{enumerate}
\begin{sol}
а, б, в, г — стационарны
\end{sol}
\end{problem}





\begin{problem}
Известно, что временной ряд $y_{t}$ порожден стационарным процессом, задаваемым соотношением $y_{t}=1+0.5y_{t-1}+\varepsilon_{t}$. Имеется 1000 наблюдений.


Вася построил регрессию $y_{t}$ на константу и $y_{t-1}$. Петя построил регрессию на константу и $y_{t+1}$.


Как примерно будут соотносится между собой их оценки коэффициентов?
\begin{sol}
Они будут примерно одинаковы. Оценка наклона определяется автоковариационной функцией.
\end{sol}
\end{problem}


\begin{problem}
Правильный кубик подбрасывают три раза, обозначим результаты подбрасываний $X_1$, $X_2$ и $X_3$. Также ввёдем обозначения для сумм $L=X_1+X_2$, $R=X_2+X_3$ и $S=X_1+X_2+X_3$.
\begin{enumerate}
\item Интуитивно, без вычислений, определите знак обычных и частных корреляций $\Corr(L, R)$, $\Corr(L, S)$, $\pCorr(L, R; S)$,
  $\pCorr(L, S; R)$, $\Corr(X_1, R)$, $\pCorr(X_1, R; S)$, $\pCorr(X_1, R; L)$, $\pCorr(L, R; X_2)$, $\pCorr(L, R; X_1)$;
\item Какие из корреляций по модулю равны единице?
\item Найдите все упомянутые обычные и частные корреляции.
\end{enumerate}
\begin{sol}

\end{sol}
\end{problem}


\begin{problem}
Известно, что $\e_t$ — белый шум. У каких разностных уравнений есть слабо стационарные решения?
\begin{enumerate}
\item $y_t=1+\e_t+0.5\e_{t-1}+0.25\e_{t-2}$
\item $y_t=-2y_{t-1}-3y_{t-2}+\e_t+\e_{t-1}$
\item $y_t=-0.5y_{t-1} + \e_t$
\item $y_t=1-1.5 y_{t-1} - 0.5 y_{t-2} + \e_t - 1.5\e_{t-1} - 0.5\e_{t-2}$
\item $y_t=1+0.64y_{t-2}+\e_t+0.64\e_{t-1}$
\item $y_t=1+t+\e_t$
\item $y_t=1+y_{t-1}+\e_t$
\end{enumerate}
\begin{sol}

\begin{enumerate}
\item $y_t=1+\e_t+0.5\e_{t-1}+0.25\e_{t-2}$ — стационарный
\item $y_t=-2y_{t-1}-3y_{t-2}+\e_t+\e_{t-1}$
\item $y_t=-0.5y_{t-1} + \e_t$ — стационарный
\item $y_t=1-1.5 y_{t-1} - 0.5 y_{t-2} + \e_t - 1.5\e_{t-1} - 0.5\e_{t-2}$
\item $y_t=1+0.64y_{t-2}+\e_t+0.64\e_{t-1}$ — стационарный
\item $y_t=1+t+\e_t$ — нестационарный
\item $y_t=1+y_{t-1}+\e_t$ — нестационарный
\end{enumerate}
\end{sol}
\end{problem}







\begin{problem}
Пусть $\e_t$ — белый шум. Рассмотрим процесс $y_t=2+0.5y_{t-1}+\e_t$ с различными начальными условиями, указанными ниже.

\begin{enumerate}
\item Найдите $\E(y_t)$, $\Var(y_t)$ и определите, является ли процесс  стационарным, если:
\begin{enumerate}
\item $y_1=0$
\item $y_1=4$
\item $y_1=4+\e_1$
\item $y_1=4+\frac{2}{\sqrt{3}}\e_1$
\end{enumerate}
\item Как точно следует понимать фразу «процесс $y_t=2+0.5y_{t-1}+\e_t$ является стационарным»?
\end{enumerate}




\begin{sol}
Процесс стационарен только при $y_1=4+\frac{2}{\sqrt{3}}\e_1$. Фразу нужно понимать как «у стохастического разностного уравнения $y_t=2+0.5y_{t-1}+\e_t$ есть стационарное решение».
\end{sol}
\end{problem}




\begin{problem}
Верно ли, что при удалении из стационарного ряда каждого второго наблюдения получается стационарный ряд?


\begin{sol}
да, стационарный
\end{sol}
\end{problem}



\begin{problem}
У эконометрессы Ефросиньи был стационарный ряд. Ей было скучно и она подбрасывала неправильную монетку, выпадающую орлом с вероятностью $0.7$. Если выпадал орёл, она оставляла очередной $y_t$, если решка — то зачёркивала. Получается ли у Ефросиньи стационарный ряд?


\begin{sol}
да, получается
\end{sol}
\end{problem}


\begin{problem}
Имеется временной ряд, $\e_1$, $\e_2$, \ldots, $\e_{101}$. Величины $\e_t$ нормально распределены, $N(0,\sigma^2)$, и независимы. Построим график этого процесса.
\begin{enumerate}
\item Является ли этот процесс белым шумом?
\item Сколько в среднем раз график пересекает ось абсцисс?
\item Оцените вероятность того, что график пересечет ось абсцисс более 60 раз.
\end{enumerate}



\begin{sol}
да, это белый шум. Величина $N$ распределена биномиально, $Bin(n=100,p=1/2)$, $\E(N)=50$.
\end{sol}
\end{problem}


\begin{problem}
Величины $x_t$ независимы и равновероятно принимают значения $0$ и $1$. Величины $y_t$ независимы и нормальны $\cN(0;24)$.
Процессы $(x_t)$ и $(y_t)$ независимы. Для каждого из пунктов ответьте на три вопроса. Верно ли, что величины $z_t$ одинаково распределены? Верно ли, что они независимы? Верно ли, что процесс $(z_t)$ — белый шум?
\begin{enumerate}
  \item $z_t = x_t (1-x_{t-1})y_t$;
\item $z_t = y_{t-1}y_t$;
\end{enumerate}
\begin{sol}

\begin{enumerate}
  \item $z_t = x_t (1-x_{t-1})y_t$;
    Процесс $z_t$ — белый шум, $\E(z_t)=0$, $\Var(z_t)=6$. Величины $z_t$ зависимы. Например, если $z_t \neq 0$, то $z_{t+1}=z_{t-1}=0$. Величины $z_t$ одинаково распределены.
\item $z_t = y_{t-1}y_t$;
Процесс $z_t$ — белый шум. Величины $z_t$ зависимы. Величины $z_t$ одинаково распределены.
\end{enumerate}


\end{sol}
\end{problem}




\begin{problem}
Величина $Z$ равновероятно принимает значения $0$ и $1$. Условное распределение вектора $X=(X_1, X_2)$ при известном $Z$ известно:
\[
  \begin{pmatrix}
    X_1 \\
    X_2 \\
  \end{pmatrix}|Z=0 \sim \cN\left(
    \begin{pmatrix}
      0 \\
      0 \\
    \end{pmatrix};
    \begin{pmatrix}
      1 & 0 \\
      0 & 1 \\
    \end{pmatrix}
    \right)
\]

\[
  \begin{pmatrix}
    X_1 \\
    X_2 \\
  \end{pmatrix}|Z=1 \sim \cN\left(
    \begin{pmatrix}
      1 \\
      1 \\
    \end{pmatrix};
    \begin{pmatrix}
      4 & -1 \\
      -1 & 9 \\
    \end{pmatrix}
    \right)
\]

Найдите
\begin{enumerate}
  \item Частную корреляцию $\pCorr(X_1, X_2; Z)$;
  \item Условную корреляцию $\Corr(X_1, X_2 | Z)$;
\end{enumerate}

  \begin{sol}
Проекции: $\tilde X_1 = X_1 + Z$; $\tilde X_2 = X_2 + Z$; $\E(X_i|Z)=1-Z$; $\Cov(X_i, Z)=-1/4$;

Величина $Z$ имеет распределение Бернулли, поэтому $\E(Z)=1/2$ и $\Var(Z)=1/4$;

\[
  \pCorr(X_1, X_2; Z) = \frac{-1/2}{12.5} = -\frac{1}{\sqrt{50}}
\]
\[
  \Corr(X_1, X_2|Z)=-Z/6
\]
  \end{sol}
\end{problem}

\begin{problem}
Приведите пример процесса каждого из четырёх типов:
\begin{enumerate}
  \item Слабостационарный и одновременно сильностационарный;
  \item Слабостационарный но не сильностационарный;
  \item Сильностационарный но не слабостационарный;
  \item Не сильностационарный и не слабостационарный.
\end{enumerate}
\begin{sol}
\begin{enumerate}
  \item $u_t \sim \cN(0;1)$ и независимы;
  \item $u_t \sim \cN(0;1)$ и независимы при $t>1$, а при $t=1$ величина $u_t$ равновероятно
  принимает значения $-1$ и $1$;
  \item Величины $u_t$ независимы и одинаково распределены с бесконечным математическим ожиданием;
  \item $u_t \sim \cN(t;1)$ и независимы.
\end{enumerate}
\end{sol}
\end{problem}







\chapter{ARMA}

\begin{problem}
Рассмотрим модель $y_t=\mu + \e_t$, где $\e_t$ — стационарный AR(1) процесс $\e_t=\rho \e_{t-1} + u_t$ с $u_t \sim N(0,\sigma^2)$. Найдите условную логарифмическую функцию правдоподобия $\ell(\mu, \rho, \sigma^2 | y_1)$.
\begin{sol}

\end{sol}
\end{problem}

\begin{problem}
Известно, что $\e_t$ — белый шум. Классифицируйте в рамках классификации ARIMA процесс $y_t=1+\e_t + 0.5\e_{t-1} + 0.4\e_{t-2} + 0.3\e_{t-3} + 0.2y_{t-1} + 0.1y_{t-2}$.
\begin{sol}

ARMA(2,3), ARIMA(2,0,3)
\end{sol}
\end{problem}


\begin{problem}
На графике представлены данные по уровню озера Гур\'{о}н в футах в 1875-1972 годах:

\begin{minted}[mathescape,
               linenos,
               numbersep=5pt,
               frame=lines,
               framesep=2mm]{r}
level <- LakeHuron
df <- data.frame(level, obs = 1875:1972)
n <- nrow(df) # used later for answers
v.acf <- acf(level, plot = FALSE)$acf
v.pacf <- pacf(level, plot = FALSE)$acf
acfs.df <- data.frame(lag = c(1:15, 1:15),
    acf = c(v.acf[2:16], v.pacf[1:15]),
    acf.type = rep(c("ACF", "PACF"), each = 15))
model <- arima(level, order = c(1, 0, 1))
resids <- model$residuals
resid.acf <- acf(resids, plot = FALSE)$acf
\end{minted}



\begin{minted}[mathescape,
               linenos,
               numbersep=5pt,
               frame=lines,
               framesep=2mm]{r}
tikz("../R_plots/huron_ts.tikz", standAlone = FALSE, bareBones = TRUE)
ggplot(df, aes(x = obs, y = level)) + geom_line() +
    labs(x = "Год", y = "Уровень озера (футы)")
dev.off()
\end{minted}


%\begin{minipage}{\textwidth}
%\begin{tikzpicture}[scale = 0.025]
%\input{R_plots/huron_ts.tikz}
%\end{tikzpicture}
%\end{minipage}




График автокорреляционной и частной автокорреляционной функций:

\begin{minted}[mathescape,
               linenos,
               numbersep=5pt,
               frame=lines,
               framesep=2mm]{r}
ggplot(acfs.df, aes(x = lag, y = acf, fill = acf.type))+
    geom_histogram(position = "dodge", stat = "identity")+
  xlab("Лаг") + ylab("Корреляция") +
  guides(fill = guide_legend(title = NULL))+
  geom_hline(yintercept = 1.96 / sqrt(nrow(df)))+
  geom_hline(yintercept = -1.96 / sqrt(nrow(df)))
\end{minted}


\begin{enumerate}
\item Судя по графикам, какие модели класса ARMA или ARIMA имеет смысл оценить?
\item По результатам оценки некоей модели ARMA c двумя параметрами, исследователь посчитал оценки автокорреляционной функции для остатков модели. Известно, что для остатков модели первые три выборочные автокорреляции равны соответственно $0.00467$, $-0.0129$ и $-0.063$. С помощью подходящей статистики проверьте гипотезу о том, что первые три корреляции ошибок модели равны нулю.
\end{enumerate}


\begin{sol}
\begin{enumerate}
\item Процесс $AR(2)$, т.к. две первые частные корреляции значимо отличаются от нуля, а гипотезы о том, что каждая последующая равна нулю не отвергаются.
\item Можно использовать одну из двух статистик
\[
\text{Ljung-Box}=n(n+2)\sum_{k=1}^3\frac{\hat{\rho}_k^2}{n-k}=
0.42886
\]
\[
\text{Box-Pierce}=n\sum_{k=1}^3\hat{\rho}_k^2=
0.4076
\]
Критическое значение хи-квадрат распределения с 3-мя степенями свободы для $\alpha=0.05$ равно $\chi^2_{3,crit}=7.81$.
Вывод: гипотеза $H_0$ об отсутствии корреляции ошибок модели не отвергается.
\end{enumerate}
\end{sol}
\end{problem}




\begin{problem}
Процесс $x_t$ — это процесс $y_t$, наблюдаемый с ошибкой, т.е. $x_t=y_t+\nu_t$. Ошибки $\nu_t$ являются белым шумом и не коррелированы с $y_t$.
\begin{enumerate}
\item Является ли процесс $x_t$ MA(1) процессом, если $y_t$ —  MA(1) процесс? Если да, то как связаны их автокорреляционные функциии?
\item Является ли процесс $x_t$ стационарным AR(1) процессом, если $y_t$ —  стационарный AR(1) процесс? Если да, то как связаны их автокорреляционные функциии?
\end{enumerate}


\begin{sol}

\end{sol}
\end{problem}


\begin{problem}
Рассмотрим стационарный AR(1) процесс $y_t=\rho y_{t-1} + \e_t$, где $\e_t \sim N(0,1)$. Имеется ряд $y_1$, $y_2$, \ldots, $y_{101}$. Построен график этого процесса. Как от $\rho$ зависит математическое ожидание количества пересечений графика с осью абсцисс?


\begin{sol}
Среднее количество пересечений равно 50 помножить на вероятность того, что два соседних $y_t$ разного знака. Найдём вдвое меньшую вероятность, $\P(y_1>0, y_2 <0)$.
\end{sol}
\end{problem}



\begin{problem}
Рассмотрим процессы:

\begin{enumerate}
\item[A] Процесс скользящего среднего:
\[
y_t=\e_t+2\e_{t-1}+3
\]

\item[B]
\[
a_t=\e_t+\e_1 + 3
\]

\item[C]
\[
b_t=t\e_t + 3
\]

\item[D]
\[
c_t=\cos\left(\frac{\pi t}{2}\right)\e_1 + \sin\left(\frac{\pi t}{2}\right)\e_2 + 2
\]

\item[E] Процесс случайного блуждания со смещением:
\[
\begin{cases}
z_t=\e_t+z_{t-1}+3 \\
z_0=0
\end{cases}
\]

\item[F] Процесс с трендом:
\[
w_t=2+3t+\e_t
\]

\item[G] Еще один процесс:
\[
r_t=\begin{cases}
1, \; \text{при четных t} \\
-1, \; \text{при нечетных t}
\end{cases}
\]

\item[H] Приращение случайного блуждания
\[
s_t=\Delta z_t
\]

\item[I] Приращение процесса с трендом
\[
d_t=\Delta w_t
\]
\end{enumerate}

Для каждого процесса:

\begin{enumerate}
\item Найдите $\E(y_t)$, $\Var(y_t)$
\item Найдите $\gamma_k = \Cov(y_t, y_{t-k})$
\item Найдите $\rho_k = \Corr(y_t,y_{t-k})$. Если ни одна корреляция $\rho_k$ не зависит от времени $t$, то постройте график зависимости $\rho_k$ от $k$.
\item Является ли процесс стационарным?
\item Сгенерируйте одну реализацию процесса. Постройте её график и график оценки автокорреляционной функции.
\end{enumerate}


\begin{sol}

\[
\E(b_t) = 3
\]

\[
\Var(b_t) = t^2 \sigma^2_{\e}
\]

\[
\Cov(b_t, b_{t-k}) = 0, k \geq 1
\]

\[
\Corr(b_t, b_{t-k}) = 0, k \geq 1
\]

$b_t$ — нестационарный из-за дисперсии


\[
\E(c_t) = 2
\]

\[
\Var(c_t) = \sigma^2_{\e}
\]

\[
\Cov(c_t, c_{t-k}) = \cos( \pi k /2)\sigma^2_{\e}, k \geq 1
\]

\[
\Corr(c_t, c_{t-k}) = \cos( \pi k /2), k \geq 1
\]

$c_t$ — стационарный
\end{sol}
\end{problem}





\begin{problem}
Эконометресса Антуанетта построила график автоковариационной функции временного ряда и распечатала его:

здесь график

Потом она с ужасом обнаружила, что до презентации исследования остается совсем мало времени, а распечатать надо было график автокорреляционной функции. Что надо исправить Антуанетте на графике, чтобы успеть еще сделать причёску и макияж (это очень важно для презентации)?



\begin{sol}
зачеркнуть одну цифру
\end{sol}
\end{problem}


\begin{problem}
Рассмотрите стационарные процессы
\begin{enumerate}
\item[A.] AR(1): $y_t = 5 + 0.3y_{t-1} + \e_t$
\item[B.] AR(2): $y_t = 5 + 0.3y_{t-1} + 0.1 y_{t-2} + \e_t$
\item[C.] MA(1): $y_t = 5 + 0.3\e_{t-1} + \e_t$
\item[D.] MA(2): $y_t = 5 + 0.3\e_{t-1} + 0.9\e_{t-2} + \e_t$
\item[E.] ARMA(1, 1): $y_t = 5 + 0.3y_{t-1} + 0.4\e_{t-1} + \e_t$
\end{enumerate}

Если возможно, то представьте каждый процесс в виде:
\begin{enumerate}
\item $MA(\infty)$.
\item $AR(\infty)$.
\item $y_t = c + \gamma_1 y_{t-1} + u_t$, где $u_t$ некоррелирован с $y_{t-1}$. Будет ли $u_t$ белым шумом?
\item $y_t = c + \gamma_1 y_{t+1} + u_t$, где $u_t$ некоррелирован с $y_{t+1}$. Будет ли $u_t$ белым шумом?
\item $y_t = c + \gamma_1 y_{t-1} + \gamma_2 y_{t-2} + u_t$, где $u_t$ некоррелирован с $y_{t-1}$ и $y_{t-2}$. Будет ли $u_t$ белым шумом?
\item $y_t = c + \gamma_1 y_{t+1} + \gamma_2 y_{t+2} + u_t$, где $u_t$ некоррелирован с $y_{t+1}$ и $y_{t+2}$. Будет ли $u_t$ белым шумом?
\end{enumerate}
\begin{sol}
\end{sol}
\end{problem}


\begin{problem}
Рассмотрите стационарные процессы
\begin{enumerate}
\item[A.] AR(1): $y_t = 5 + 0.3y_{t-1} + \e_t$
\item[B.] AR(2): $y_t = 5 + 0.3y_{t-1} + 0.1 y_{t-2} + \e_t$
\item[C.] MA(1): $y_t = 5 + 0.3\e_{t-1} + \e_t$
\item[D.] MA(2): $y_t = 5 + 0.3\e_{t-1} + 0.9\e_{t-2} + \e_t$
\item[E.] ARMA(1, 1): $y_t = 5 + 0.3y_{t-1} + 0.4\e_{t-1} + \e_t$
\end{enumerate}

Для каждого из процессов:
\begin{enumerate}
\item Найдите математическое ожидание $\E(y_t)$.
\item Найдите первые три значения автокорреляционной функции $\rho_1$, $\rho_2$, $\rho_3$.
\item Найдите первые три значения частной автокорреляционной функции $\phi_{11}$, $\phi_{22}$, $\phi_{33}$.
\end{enumerate}
\begin{sol}
\end{sol}
\end{problem}

\begin{problem}
  Известна автокорреляционная функция процесса $(y_t)$: $\rho_1 = 0.7$, $\rho_2 = 0.3$, и $\rho_k = 0$ при $k\geq 3$. Кроме того, $\E(y_t)=4$. Выпишите возможные уравнения процесса.
\begin{sol}
\end{sol}
\end{problem}

\begin{problem}
  Известна частная автокорреляционная функция процесса $(y_t)$: $\phi_{11} = 0.7$, $\phi_{22} = 0.3$, и $\phi_{kk} = 0$ при $k\geq 3$. Кроме того, $\E(y_t)=4$. Выпишите возможные уравнения процесса.
\begin{sol}
\end{sol}
\end{problem}

\begin{problem}
Если возможно, то найдите процесс с данной автокорреляционной или частной автокорреляционной функцией.

\begin{enumerate}
  \item $ACF = (0.9, -0.9, 0, 0, 0, \ldots)$;
  \item $PACF = (0.9, -0.9, 0, 0, 0, \ldots)$;
  \item $PACF = (0.9, 0, 0, 0, 0, \ldots)$;
  \item $PACF = (0, 0.9, 0, 0, 0, 0, \ldots)$;
  \item $ACF = (0.9, 0, 0, 0, 0, \ldots)$;
  \item $ACF = (0, 0.9, 0, 0, 0, 0, \ldots)$;
\end{enumerate}

\begin{sol}
  \begin{enumerate}
    \item $ACF = (0.9, -0.9, 0, 0, 0, \ldots)$ не бывает, так как определитель корреляционной матрицы 3 на 3 отрицательный;
    \item $PACF = (0.9, -0.9, 0, 0, 0, \ldots)$ — AR(2);
    \item $PACF = (0.9, 0, 0, 0, 0, \ldots)$ — $y_t = 0.9y_{t-1} + u_t$;
    \item $PACF = (0, 0.9, 0, 0, 0, 0, \ldots)$ — $y_t = 0.9y_{t-2} + u_t$;
    \item $ACF = (0.9, 0, 0, 0, 0, \ldots)$ — не бывает, подозрение падает на MA(1), но решения только с комплексными коэффициентами, геометрически: два угла с косинусом 0.9, то есть примерно по 30 градусов, и они даже в сумме не могут дать перпендикуляр;
    \item $ACF = (0, 0.9, 0, 0, 0, 0, \ldots)$ — не бывает, если проредить процесс через один, то должна получится невозможная ACF;
  \end{enumerate}
   В целом PACF может быть любая,
   \url{http://projecteuclid.org/euclid.aos/1176342881}.
\end{sol}
\end{problem}


\begin{problem}
Рассмотрим стационарный процесс $y_t = 4 + 0.7y_{t-1} - 0.12y_{t-2} + \e_t$, где $\e_t$ — белый шум, причём $\Cov(\e_t, y_{t-k})=0$ при $k \geq 1$.

\begin{enumerate}
  \item Найдите автокорреляционную функцию: $\rho_1$, $\rho_2$ и общую формулу для $\rho_k$.
  \item Найдите $\lim_{k \to \infty} \rho_k$.
  \item Найдите частную автокорреляционную функцию: $\phi_{11}$, $\phi_{22}$, \ldots.
\end{enumerate}
\begin{sol}
  $\phi_{kk}=0$ при $k \geq 3$.
\end{sol}
\end{problem}


\begin{problem}
Рассмотрим стационарный процесс с уравнением
\[
y_t = 10 + 0.69 y_{t-1} + \e_t - 0.71 \e_{t-1}.
\]

Выпишите гораздо более простой процесс со свойствами близкими к свойствам данного процесса.
\begin{sol}
Заметим, что $0.69\approx 0.71$, сокращаем множитель $1-0.7L$, получаем $y_t = 100/3 + \e_t$.
\end{sol}
\end{problem}


\begin{problem}
Процесс $\e_t$ — белый шум. Рассмотрим уравнение
\[
y_t = 0.5 y_{t-1} + \e_t.
\]

Какие из указанных процессов $(y_t)$ являются его решением? Стационарным решением?
\begin{enumerate}
  \item $y_t = 0.5^t$;
  \item $y_t = \sum_{i=0}^{\infty} 0.5^i \e_{t-i}$;
  \item $y_t = 0.5^t + \sum_{i=0}^{\infty} 0.5^i \e_{t-i}$;
  \item $y_t = 0.5^t\e_{100} + \sum_{i=0}^{\infty} 0.5^i \e_{t-i}$;
  \item $y_t = 0.5^t + \sum_{i=0}^{t} 0.5^i \e_{t-i}$;
  \item $y_t = \sum_{i=0}^{t} 0.5^i \e_{t-i}$;
\end{enumerate}


\begin{sol}
Стационарным решением является $y_t = \sum_{i=0}^{\infty} 0.5^i \e_{t-i}$. Решениями также являются: $y_t = 0.5^t + \sum_{i=0}^{\infty} 0.5^i \e_{t-i}$, $y_t = 0.5^t\e_{100} + \sum_{i=0}^{\infty} 0.5^i \e_{t-i}$, $y_t = 0.5^t + \sum_{i=0}^{t} 0.5^i \e_{t-i}$, $y_t = \sum_{i=0}^{t} 0.5^i \e_{t-i}$.
\end{sol}
\end{problem}



\begin{problem}

Рассмотрим стационарный процесс $y_t$, задаваемый уравнением
\[
y_t = 2 + 0.6 \cdot y_{t-1} - 0.08 y_{t-2} + \e_t,
\]
где $\e_t \sim \cN(0; 4)$.

\begin{enumerate}
\item  Найдите $\E_t(y_{t+1})$, $\Var_t(y_{t+1})$
\item Найдите $\E_t(y_{t+2})$, $\Var_t(y_{t+2})$
\item Постройте 95\%-ый предиктивный интервал для $y_{102}$, если $y_{99}=5$, $y_{100}=5.1$
\item Найдите $\E(y_t)$, $\Var(y_t)$
\item Найдите $\lim_{h\to\infty}\E_t(y_{t+h})$, $\lim_{h\to\infty}\Var_t(y_{t+h})$
\end{enumerate}


\begin{sol}

$\E_t(y_{t+1})=2+0.6y_{t-1}-0.08y_{t-2}$, $\Var_t(y_{t+1})=4$

$\E_t(y_{t+2})=3.2 + 0.28 y_t- 0.048y_{t-1}$, $\Var_t(y_{t+2})=1.36 \cdot 4$

$\E_{100}(y_{102})= 4.388$, $\Var_{100}(y_{102})=5.44$.

Предиктивный интервал $[4.388 - 1.96 \sqrt{5.44};4.388 + 1.96 \sqrt{5.44}]$

$\E(y_t)=\frac{2}{0.48}\approx 4.17$

\end{sol}
\end{problem}



\begin{problem}
Задан процесс $y_t = 7 + u_t + 0.2 u_{t-1}$, где $u_t$ независимы и нормальны $u_t \sim \cN(0;4)$. Известно, что $y_{100}=7.2$, $u_{100}=1.3$, $y_{100}+(-0.2)y_{99}+(-0.2)^2y_{98}+\ldots+(-0.2)^{99}y_1=5.6$.

Пусть $\cF_t=\sigma(y_t, y_{t-1}, \ldots, y_1, u_t, u_{t-1}, \ldots, u_1)$ и $\cH_t = \sigma(y_t, y_{t-1}, \ldots, y_1)$.
\begin{enumerate}
  \item Найдите $\E(y_{101}|\cF_{100})$, $\Var(y_{101}|\cF_{100})$.
  \item С помощью $AR(\infty)$ представления примерно найдите $\E(y_{101}|\cH_{100})$, $\Var(y_{101}|\cH_{100})$. Постройте 95\%-ый предиктивный интервал для $y_{101}$.
  \item Найдите $\E(y_{101}|y_{100})$, $\Var(y_{101}|y_{100})$.
  \item Найдите $\E(y_{101}|y_{100}, y_{99})$, $\Var(y_{101}|y_{100}, y_{99})$.
\end{enumerate}

\begin{sol}
Заметим, что $\Var(u_t|\cF_t)=0$. Более того, для обратимого процесса $\Var(u_t|y_t, y_{t-1}, \ldots, y_1) \approx \Var(u_t|y_t, y_{t-1}, \ldots) = 0$.
\[
\E(y_{101}|y_{100})=7 + 0 + 0.2\E(u_{100}|y_{100})
\]
\[
\E(u_{100}|y_{100}) = \beta_1 + \beta_2 y_{100}
\]
\[
\beta_2 = \frac{\Cov(y_{100}, u_{100})}{\Var(y_{100})}=4/4.16, \beta_1 = \E(u_{100}) - \beta_2 \E(y_{100})=-4\cdot 7/4.16
\]
\[
\frac{y_t}{1+0.2L} = \frac{7}{1+0.2L} + u_t
\]
Заметим, что $\frac{7}{1+0.2L}=7/1.2$, так как $L\cdot 7 = 7$ (вчера семь равнялось семи).

По условию $\frac{y_{100}}{1+0.2L} \approx 5.6$. Знак «примерно равно» возникает из-за замены бесконечной суммы на конечную.

\end{sol}
\end{problem}



\begin{problem}
  У исследовательницы Аграфены три наблюдения, $y_1 = 0.1$, $y_2 = -0.2$, $y_3 = 0.2$. Аграфена предполагает, что данные подчиняются стационарному AR(1) процессу $y_t = \beta y_{t-1} + u_t$, где $u_t \sim \cN(0;\sigma^2_u)$.

  \begin{enumerate}
    \item Найдите $\E(y_1)$, $\E(y_2|y_1)$, $\E(y_3|y_2)$;
    \item Найдите $\Var(y_1)$, $\Var(y_2|y_1)$, $\Var(y_3|y_2)$;
    \item Найдите функции плотности $f(y_1)$, $f(y_2|y_1)$, $f(y_3|y_2)$;
    \item Выпишете полную логарифмическую функцию правдоподобия $\ell(y|\beta, \sigma^2_u)$.
    \item Если возможно, явно решите задачу максимизации полного правдоподобия.
    \item Выпишите условную логарифмическую функцию правдоподобия $\ell(y_2, y_3|\beta, \sigma^2_u, y_1)$.
    \item Если возможно, явно решите задачу максимизации условного правдоподобия при фиксированном $y_1$.
  \end{enumerate}
  \begin{sol}
    $\E(y_1)=0$, $\Var(y_1)=\sigma^2_u/(1-\beta^2)$, $\E(y_t|y_{t-1})=\beta y_{t-1}$, $\Var(y_t|y_{t-1})=\sigma^2_u$.

    При максимизации условного правдоподобия получаем:
    \[
         \hb = \frac{y_1 y_2 + y_2 y_3}{y_1^2 + y_2^2}
    \]
  \end{sol}
\end{problem}

\begin{problem}
  Белые шумы $u_t$ и $v_t$ независимы, $\Var(u_t) = 1$, $\Var(v_t)=1$. Рассмотрим процесс $y_t = 5u_{t-1} - 4 v_{t-1} + u_t + v_t$.

  \begin{enumerate}
    \item Выпишите классическое представление процесса $y_t$ как ARMA-процесса.
    \item Выразите белый шум из полученного классического представления $y_t$ через белые шумы $(u_t)$ и $(v_t)$.
  \end{enumerate}
  \todo[inline]{можно подобрать цифры, чтобы коэффициент был хороший :)}
  \begin{sol}
  \end{sol}
\end{problem}









\chapter{ETS}


\begin{problem}
  Рассмотрим ETS-ANN модель с $\alpha = 1/2$, $y_1=6$, $y_2=9$, $y_3 = 6$, $\sigma^2=9$.


  \begin{enumerate}
    \item Найдите величину $l_0$, которая минимизирует $RSS$;
    \item Постройте точечный прогноз $\hat y_{4|2}$, $\hat y_{5|2}$;
     \item Постройте 95\%-ый предиктивный интервал для $y_{4}$ и $y_{5}$.
  \end{enumerate}
\begin{sol}
\end{sol}
\end{problem}

\begin{problem}
  Рассмотрим ETS-AAN модель с $\alpha = 1/2$, $\beta=3/4$, $l_{0}=7$, $b_0=2$, $y_1=6$, $y_2=9$, $y_3=3$, $\sigma^2=9$.
  \begin{enumerate}
    \item Постройте точечный прогноз $\hat y_{4|3}$, $\hat y_{5|3}$;
    \item Постройте 95\%-ый предиктивный интервал для $y_{4}$ и $y_{5}$.
  \end{enumerate}
\begin{sol}
\end{sol}
\end{problem}

\begin{problem}
  Рассмотрим ETS-AAN модель с $\alpha = 1/2$, $\beta=3/4$, $l_{0}=7$, $y_1=6$, $y_2=9$, $\sigma^2=16$.


  \begin{enumerate}
    \item Найдите величину $b_0$, которая минимизирует $RSS$;
    \item Постройте точечный прогноз $\hat y_{3|2}$, $\hat y_{4|2}$;
     \item Постройте 95\%-ый предиктивный интервал для $y_{3}$ и $y_{4}$.
  \end{enumerate}
\begin{sol}
\end{sol}
\end{problem}

\begin{problem}
  Рассмотрим ETS-AAN модель с $\alpha = 1/2$, $\beta=3/4$, $l_{0}=7$, $y_1=6$, $y_2=9$, $y_3=3$.

  Выпишите сумму квадратов ошибок прогнозов на один шаг вперёд через $b_0$.
  % минимизация тут длинная
\begin{sol}
\end{sol}
\end{problem}



\begin{problem}
  Рассмотрим ETS-AAN модель с $\alpha = 1/2$, $\beta=3/4$, $l_{99}=8$, $b_{99}=1$, $y_{99}=10$, $y_{100}=8$, $\sigma^2=16$.
  \begin{enumerate}
    \item Найдите $l_{100}$, $b_{100}$, $l_{98}$, $b_{98}$;
    \item Постройте точечный прогноз $\hat y_{101|100}$, $\hat y_{102|100}$;
    \item Постройте 95\%-ый предиктивный интервал для $y_{101}$ и $y_{102}$.
  \end{enumerate}
\begin{sol}
\end{sol}
\end{problem}


\begin{problem}
Для каждой из ETS моделей найдите эквивалентную модель класса ARIMA:
	\begin{enumerate}
		\item Простое экспоненциальное сглаживание, ETS-ANN;
		\item Аддитивное сглаживание Хольта, ETS-AAN;
		\item Аддитивное сглаживание Хольта с угасающим трендом, ETS-AAdN;
		\item Аддитивное сглаживание Хольта-Винтерса для месячных данных, ETS-AAA;
		\item Аддитивное сглаживание Хольта-Винтерса с угасающим трендом для месячных данных, ETS-AAdA;
		\item ETS-ANA;
	\end{enumerate}
\begin{sol}
	\begin{enumerate}
		\item Простое экспоненциальное сглаживание, ETS-ANN; ARIMA(0,1,1)
		\item Аддитивное сглаживание Хольта, ETS-AAN; ARIMA(0,2,2)
		\item Аддитивное сглаживание Хольта с угасающим трендом, ETS-AAdN; ARIMA(1,1,2)
		\item Аддитивное сглаживание Хольта-Винтерса для месячных данных, ETS-AAA; ARIMA(0,1,13)-SARIMA(0,1,0)
		\item Аддитивное сглаживание Хольта-Винтерса с угасающим трендом для месячных данных, ETS-AAdA; ARIMA(0,1,13)-SARIMA(0,1,0)
		\item ETS-ANA; ARIMA(0,1,12)-SARIMA(0,1,0)
	\end{enumerate}
\end{sol}
\end{problem}


\begin{problem}
  Рассмотрим ETS-AAN модель. По каким параметрам модели оптимальные точки можно получить в явном виде?


\begin{sol}
По $l_0$, $b_0$;
\end{sol}
\end{problem}





\chapter{TBATS}


\begin{problem}
  Найдите предел
  \[
    \lim_{w \to 0} \frac{y^w - 1}{w}
  \]
\begin{sol}
  $\ln y$
\end{sol}
\end{problem}








\chapter{Вступайте в ряды Фурье!}


Суть преобразования Фурье. Вместо исходного временного ряда $x_0$, $x_1$, \ldots, $x_{N-1}$ мы получаем ряд комплексных чисел $X_0$, $X_1$, \ldots, $X_{N-1}$.
Эти комплексные числа $X_k$ показывают, насколько сильно проявляется каждая частота в исходном ряду.

Чтобы получить одно комплексное число $X_k$:

\begin{enumerate}
  \item Разрежем круг на $N$ равных частей. Каждая часть образует угол $2\pi/N$.
  \item Разместим исходные числа $x_0$, $x_1$, \ldots, $x_{N-1}$ на разрезах по часовой стрелке с шагом $k$.
    При этом число $x_0$ приходится на угол $0$; число $x_1$ — на угол $2\pi/N \cdot k$;
число $x_2$ — на угол $2\pi/N \cdot 2k$, и так далее.
  \item Трактуем $x_i$ как силу ветра в направлении разреза.
  \item $X_k$ — усреднённая сила ветра.
\end{enumerate}


Прямое преобразование Фурье задаётся формулой\footnote{Иногда множитель $1/N$ относят к обратному преобразованию Фурье, иногда поровну разносят как $1/\sqrt{N}$.}:
\[
  X_k = \frac{1}{N} \sum_{n=0}^{N-1} x_n w^{kn},
\]
где комплексное число $w$ кодирует поворот на $1/N$ часть круга по часовой стрелке, $w = \exp\left(\frac{-2i\pi}{N} \right)$.



Обратное преобразование Фурье
\[
  x_n = \sum_{k=0}^{N-1} X_k (w^{*})^{nk},
\]
где комплексное число $w^{*}$ является сопряжённым к числу $w$.


\begin{problem}
  Немножко теории:
  \begin{enumerate}
    \item Посмотрите видео от 3blue1brown, \url{https://www.youtube.com/watch?v=cV7L95IkVdE}.
    \item Прочтите про дискретное преобразование Фурье на brilliant, \url{https://brilliant.org/wiki/discrete-fourier-transform/}.
  \end{enumerate}
\begin{sol}
\end{sol}
\end{problem}



\begin{problem}
  Про Фурье :)
  \begin{enumerate}
    \item Зачем Фурье собирал огарки свечей в бенедиктинской артиллерийской школе?
    \item Первый раз Фурье был арестован за недостаточную поддержку якобинцев. За что Фурье был арестован во второй раз?
    \item Что было в руке у Фурье во время переговоров о перемирии после потери французами Каира?
  \end{enumerate}
  \begin{sol}
    \begin{enumerate}
      \item Чтобы заниматься математикой по ночам.
      \item За поддержку якобинцев.
      \item Кофейник. Был разбит пулей.
    \end{enumerate}
\end{sol}
\end{problem}


\begin{problem}
  Вспомним комплексные числа :)
  \begin{enumerate}
    \item Найдите сумму $7 + 7 \exp(2i\pi/3) + 7 \exp(4i\pi/3)$;
    \item Найдите сумму $6 + 4\exp(i\pi)$;
  \end{enumerate}

  \begin{sol}
  \end{sol}
\end{problem}


\begin{problem}
Найдите прямое преобразование Фурье последовательностей
\begin{enumerate}
  \item $1$, $4$, $1$, $4$, $1$, $4$;
  \item $1$, $9$;
  \item $8$;
  \item $1$, $0$, $0$, $0$;
\end{enumerate}
  \begin{sol}
  \end{sol}
\end{problem}

\begin{problem}
  Прямое преобразование Фурье можно записать в матричном виде $X = \frac{1}{N}Fx$.
  \begin{enumerate}
    \item Как устроена матрица $F$?
    \item Найдите $F\cdot F^{*}$, где $F^{*}$ — транспонированная и сопряжённая матрица к $F$;
    \item Как устроена матрица $F^{-1}$?
    \item Как записывается обратное преобразование Фурье в матричном виде?
  \end{enumerate}

  \begin{sol}
  \end{sol}
\end{problem}


\begin{problem}

Обратное преобразование Фурье задаётся формулой
\[
  x_n = \sum_{k=0}^{N-1} X_k (w^{*})^{nk},
\]
где комплексное число $w^{*}$ является сопряжённым к числу $w = \exp\left(\frac{-2i\pi}{N} \right)$.


  Докажите, что обратное преобразование Фурье, действительно, от комплексных чисел $(X_k)$ переходит к исходныму ряду $(x_n)$.
  \begin{sol}
  \end{sol}
\end{problem}


\begin{problem}
  В типичной задаче исходный ряд $x_0$, $x_1$, \ldots, $x_{N-1}$ является действительными числами.
  Докажите, что при дискретном преобразовании Фурье числа $X_k$ и $X_{N-k}$ являются комплексно-сопряжёнными.

  \begin{sol}
  \end{sol}
\end{problem}


\begin{problem}
  Рассмотрим ряд месячной периодичности. Число наблюдений делится на 12. Исследователь Василий рассматривает в качестве регрессоров следующие переменные: столбец из единиц,
  $\sin\left(\frac{2\pi}{12} t\right)$,
 $\cos\left(\frac{2\pi}{12} t\right)$,
 $\sin\left(\frac{2\pi}{12} 2t\right)$,
 $\cos\left(\frac{2\pi}{12} 2t\right)$,
 $\sin\left(\frac{2\pi}{12} 3t\right)$,
 $\cos\left(\frac{2\pi}{12} 3t\right)$,
 $\sin\left(\frac{2\pi}{12} 4t\right)$,
 $\cos\left(\frac{2\pi}{12} 4t\right)$,
 $\sin\left(\frac{2\pi}{12} 5t\right)$,
 $\cos\left(\frac{2\pi}{12} 5t\right)$,
 $\cos\left(\frac{2\pi}{12} 6t\right)$.

 \begin{enumerate}
   \item Являются ли эти регрессоры ортогональными?
   \item Василий рассматривает два варианта действий.
     Вариант А: построить 12 регрессий исходного ряда на каждый регрессор в отдельности. Вариант Б: построить одну регрессию.
     Будут ли отличаться коэффициенты при регрессорах?
    \item Можно ли добавить в качестве регрессора $\sin\left(\frac{2\pi}{12} 6t\right)$ или  $\cos\left(\frac{2\pi}{12} 7t\right)$?
  \end{enumerate}
 \begin{sol}
   Да, ряды являются ортогональными. Можно строить регрессии на эти регрессоры в любых комбинациях, оценки бет выходят одни и те же.
   Другие ряды добавить нельзя — будет строгая мультиколлинеарность.
 \end{sol}
 \end{problem}

 \begin{problem}
   Исследовательница Агриппина взяла ряд длиной 6 наблюдений и построила его регрессию на тригонометрические ряды Фурье:
   \[
     \hat x_t = 3.5 - 1.73 \sin(2\pi t/6) + 1.00 \cos(2\pi t/6) - 0.58\sin(4\pi t/6) + 1.00 \cos(4\pi t/6) +0.30 \cos(6\pi t/6)
   \]

   Найдите прямое преобразование Фурье исходного ряда.
   \begin{sol}
     На всякий случай, это был ряд $1$, $2$, $3$, $4$, $5$, $6$.
   \end{sol}
 \end{problem}


 \begin{problem}
   Исследовательница Агриппина взяла ряд длиной 6 наблюдений и нашла его преобразование Фурье:
   \[
     1.5, \; -\frac{1}{6}+\frac{1}{\sqrt{12}}i, \; 0, \; -\frac{1}{6}, \; 0, -\frac{1}{6} - \frac{1}{\sqrt{12}}i.
   \]
   \begin{enumerate}
     \item Найдите регрессию этого ряда на тригонометрические ряды Фурье;
     \item Восстановите исходный ряд;
   \end{enumerate}

   \begin{sol}
   $1$, $1$, $1$, $2$, $2$, $2$
   \end{sol}
 \end{problem}


\Closesolutionfile{solution_file}
